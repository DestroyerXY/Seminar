Прошу смотреть ветки 3, 4, 5, 6
